<!doctype html><html lang=en-us><head><meta charset=utf-8><title>Docker for Admins - Workshop | Edenmal - Sysadmin Garden of Eden</title>
<meta name=author content="Alexander Trost"><meta name=description content="This post is deprecated! Please move on to the new version of this post."><meta name=twitter:site content="@galexrt"><meta name=twitter:title content="Docker for Admins - Workshop | Edenmal - Sysadmin Garden of Eden"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://edenmal.moe/post/covers/docker-logo-vertical.png"><meta name=twitter:description content="This post is deprecated! Please move on to the new version of this post."><meta property="og:type" content="article"><meta property="og:title" content="Docker for Admins - Workshop"><meta property="og:description" content="This post is deprecated! Please move on to the new version of this post."><meta property="og:url" content="https://edenmal.moe/post/2016/Docker-for-Admins-Workshop/"><meta property="og:image" content="https://edenmal.moe/post/covers/docker-logo-vertical.png"><meta name=generator content="Hugo 0.120.4"><link rel=canonical href=https://edenmal.moe/post/2016/Docker-for-Admins-Workshop/><meta name=renderer content="webkit"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=format-detection content="telephone=no,email=no,adress=no"><meta http-equiv=Cache-Control content="no-transform"><meta name=robots content="index,follow"><meta name=referrer content="origin-when-cross-origin"><meta name=theme-color content="#4d4ac7"><meta name=apple-mobile-web-app-capable content="yes"><meta name=apple-mobile-web-app-status-bar-style content="black"><meta name=apple-mobile-web-app-title content="Edenmal"><meta name=msapplication-tooltip content="Edenmal"><meta name=msapplication-navbutton-color content="#4d4ac7"><meta name=msapplication-TileColor content="#4d4ac7"><meta name=msapplication-TileImage content="/icons/icon-144x144.png"><link rel=icon href=https://edenmal.moe/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://edenmal.moe/icons/icon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://edenmal.moe/icons/icon-32x32.png><link rel=icon sizes=192x192 href=https://edenmal.moe/icons/icon-192x192.png><link rel=apple-touch-icon href=https://edenmal.moe/icons/icon-152x152.png><link rel=manifest href=https://edenmal.moe/manifest.json><link rel=preload href=https://edenmal.moe/styles/main-rendered.min.css as=style><link rel=preload href=https://edenmal.moe/images/avatar.png as=image><link rel=preload href=https://edenmal.moe/images/grey-prism.svg as=image><style>body{background-color:#f4f3f1;background-image:url(/images/grey-prism.svg);background-repeat:repeat;background-attachment:fixed}</style><link rel=stylesheet href=https://edenmal.moe/styles/main-rendered.min.css><link rel=stylesheet href=https://edenmal.moe/cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe.min.min.css><link rel=stylesheet href=https://edenmal.moe/cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/default-skin/default-skin.min.min.css><script src=https://edenmal.moe/cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe.min.min.819c76b4bba0f8b8c568f6e4860173f1d16e5046c01b008f4705ae823b5766e1.js integrity="sha256-gZx2tLug+LjFaPbkhgFz8dFuUEbAGwCPRwWugjtXZuE="></script><script src=https://edenmal.moe/cdnjs.cloudflare.com/ajax/libs/photoswipe/4.1.3/photoswipe-ui-default.min.min.2fcfc43be15566e9378af0e8247ba57fec8d4ee95c5dba15cf97e84d6c2115bc.js integrity="sha256-L8/EO+FVZuk3ivDoJHulf+yNTulcXboVz5foTWwhFbw="></script><script src=https://edenmal.moe/cdnjs.cloudflare.com/ajax/libs/jquery/1.12.4/jquery.min.min.77ec5e7d7f844e9b6c2413a352b48194493a65c75d94d5cd9679a225c2da773c.js integrity="sha256-d+xefX+ETptsJBOjUrSBlEk6ZcddlNXNlnmiJcLadzw="></script><script src=https://edenmal.moe/scripts/pswp-init.min.299a530b67d8be41667aa9ed78920e272e970b0ac8ab7540ba3a7c1382b52de2.js integrity="sha256-KZpTC2fYvkFmeqnteJIOJy6XCwrIq3VAujp8E4K1LeI="></script></head><body><div class=suspension><a role=button aria-label="Go to top" title="Go to top" class="to-top is-hide"><span class=icofont-caret-up aria-hidden=true></span></a>
<a role=button aria-label="Print page" title="Print page" class=print-page onclick=window.print()><span class=icofont-print aria-hidden=true></span></a></div><header class=site-header><a class=avatara href=https://edenmal.moe/><img class=avatar src=https://edenmal.moe/images/avatar.png alt=Avatar></a><h2 class=title><a href=https://edenmal.moe/>Edenmal</a></h2><p class=subtitle>Sysadmin Garden of Eden</p><button class=menu-toggle type=button aria-label="Main Menu" aria-expanded=false tab-index=0>
<span class=icofont-navigation-menu aria-hidden=true></span></button><nav class="site-menu collapsed"><h2 class=offscreen>Main Menu</h2><ul class=menu-list><li class="menu-item
is-active"><a href=https://edenmal.moe/>Home</a></li><li class=menu-item><a href=https://edenmal.moe/about/>About</a></li><li class=menu-item><a href=https://edenmal.moe/tags/>Tags</a></li><li class=menu-item><a href=https://edenmal.moe/events/>Events</a></li><li class=menu-item><a href=https://edenmal.moe/site-notice/>Impressum</a></li></ul></nav><nav class="social-menu collapsed"><h2 class=offscreen>Social Networks</h2><ul class=social-list><li class=social-item><a href=mailto:me@galexrt.moe title=Email aria-label=Email><span class=icofont-envelope aria-hidden=true></span></a></li><li class=social-item><a href=https://galexrt.moe/ rel=me title=Homepage aria-label=Homepage><span class=icofont-page aria-hidden=true></span></a></li><li class=social-item><a href=//github.com/galexrt rel=me title=GitHub aria-label=GitHub><span class=icofont-github aria-hidden=true></span></a></li><li class=social-item><a href=//twitter.com/galexrt rel=me title=Twitter aria-label=Twitter><span class=icofont-twitter aria-hidden=true></span></a></li><li class=social-item><a href=//www.linkedin.com/in/alexander-trost rel=me title=LinkedIn aria-label=LinkedIn><span class=icofont-linkedin aria-hidden=true></span></a></li><li class=social-item><a href=//www.xing.com/profile/Alexander_Trost18 rel=me title=XING aria-label=XING><span class=icofont-xing aria-hidden=true></span></a></li><li class=social-item><a rel=alternate type=application/rss+xml href=https://edenmal.moe/index.xml title=RSS aria-label=RSS><span class=icofont-rss aria-hidden=true></span></a></li></ul></nav></header><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
</button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><section class="main post-detail"><header class=post-header><h1 class=post-title>Docker for Admins - Workshop</h1><p class=post-meta>Author Alexander Trost · Read Time 24 minutes · Created Tue Mar 8 14:39:00 2016 · Updated Fri Mar 25 21:33:36 2022</p></header><article class=post-content><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><a href=https://edenmal.moe/post/covers/docker-logo-vertical.png itemprop=contentUrl><img itemprop=thumbnail src=https://edenmal.moe/post/covers/docker-logo-vertical.png width=250px></a></figure><h2>Table of Contents</h2><nav id=TableOfContents><ul><li><ul><li><a href=#this-workshop-is-deprecated>This workshop is deprecated!</a></li><li><a href=#goal-of-the-workshop>Goal of the Workshop</a></li><li><a href=#heads-up---blogger-words>Heads up - &ldquo;Blogger&rdquo; Words</a></li><li><a href=#group-partitions>Group &ldquo;Partitions&rdquo;</a></li><li><a href=#special-details>Special details</a></li><li><a href=#readme-before-begining>README before begining!</a></li><li><a href=#intro-container-and-microservices>Intro: Container and Microservices</a></li><li><a href=#prepare-for-the-docker-madness>Prepare for the Docker Madness</a></li><li><a href=#everything-working-good-lets-go>Everything working? Good, let&rsquo;s go!</a></li><li><a href=#how-can-the-containers-talk-local-and-multi-host>How can the containers talk? Local and multi host?</a></li><li><a href=#data-and-layer-cakes-in-docker>Data and Layer Cakes in Docker</a></li><li><a href=#take-an-image---create-your-first-docker-image>Take an image! - Create your first Docker image</a></li></ul></li></ul><ul><li><ul><li></li><li><a href=#docker-composeyml-aka-simpleness-for-multi-container-applications>docker-compose.yml aka &ldquo;Simpleness for multi container applications&rdquo;</a></li><li><a href=#kubessar---glossar>Kubessar - Glossar</a></li><li><a href=#conductor-of-the-orchestra---kubernetes>Conductor of the orchestra - Kubernetes</a></li><li><a href=#first-deployment-with-kubernetes>First Deployment with Kubernetes</a></li><li><a href=#high-availability-and-balancing-with-loads---kubernetes>High Availability and &ldquo;Balancing with Loads&rdquo; - Kubernetes</a></li><li><a href=#the-end>The End</a></li><li><a href=#solutions>Solutions</a></li></ul></li></ul></nav><hr><h3 id=this-workshop-is-deprecated>This workshop is deprecated!</h3><p><strong>Please use the new version of the &ldquo;Docker for Admins&rdquo; Workshop post, <a href=https://edenmal.moe/post/2016/Docker-for-Admins-Workshop-v2/>here</a>.</strong></p><hr><h3 id=goal-of-the-workshop>Goal of the Workshop</h3><p>The Goal is to show how easy it is to use Docker.
The simpleness in creating an image for an own project/application.
If there&rsquo;s enough time, we also look at how to orchestrate a Kubernetes cluster and let the first containers run on the cluster.</p><h3 id=heads-up---blogger-words>Heads up - &ldquo;Blogger&rdquo; Words</h3><ul><li><strong>Grey Boxes with green line on the left</strong>: Mostly contain an useful tip, expected command output or something funny.</li><li><strong>TASK</strong>: Is a refer to a task in the workshop repo mostly in the <code>tasks/</code> folder.</li><li><strong>WDWD</strong>: Stands for &ldquo;What does what do&rdquo; aka &ldquo;Me explaining what the things listed below do&rdquo; (short forms FTW!), I only explain new things in this section.</li></ul><h3 id=group-partitions>Group &ldquo;Partitions&rdquo;</h3><p>At least 2 groups with 2-3 or more people. Every group will work on their own <a href=http://kubernetes.io/>Kubernetes</a> cluster.
If there are people that aren&rsquo;t as &ldquo;advanced&rdquo;, they can play around with <a href=https://docs.docker.com/swarm/overview/>Docker Swarm</a> (No tutorial provided in this post!).</p><h3 id=special-details>Special details</h3><p>The VirtualBox is available under <em>INSERT_DOWNLOAD_LINK_HERE</em>.
(Most likely to be given around with an USB stick at the workshop day)</p><ul><li>VM Username: <code>workshop</code></li><li>VM Password: <code>workshop</code></li></ul><h4 id=whats-in-the-fcking-box>&ldquo;What&rsquo;s in the f*cking box?!&rdquo;</h4><p><a href="https://www.youtube.com/watch?v=HOkLPjaVK_w"><em>Did I hear &ldquo;Box&rdquo;?!</em></a></p><p>Fedora 23 with Docker and Cockpit enabled.
Firewalld removed, Iptables cleared and persistence disabled.</p><h4 id=why-is-the-vm-running-fedora>Why is the VM running Fedora?</h4><p>That&rsquo;s simple. It is more up to date, than Debian :P and uses a up to date kernel.</p><hr><h3 id=readme-before-begining>README before begining!</h3><p>If you don&rsquo;t know any further, add <strong><code>--help</code></strong> to the command, to get a help page that may guide you to your goal or use <strong><code>man INSERT_COMMAND_HERE</code></strong> to show the man(ual) page for the given command.</p><blockquote><p>There are no dumb questions, but please don&rsquo;t ask them. Okay?
&ndash; <em>Alexander Trost</em></p></blockquote><hr><h3 id=intro-container-and-microservices>Intro: Container and Microservices</h3><h4 id=why-do-people-like-the-docker-principle>Why do people like the Docker-&ldquo;Principle&rdquo;?</h4><p>Because the Docker-&ldquo;Principle&rdquo; means &ldquo;simpleness&rdquo;. You want WordPress? One command and you&rsquo;re good to go. Enough said.</p><h4 id=micro-what-microservices>Micro-what? Microservices!</h4><p>Microservices allow you to test local, small scale, and run large (<em>if done right</em>), large scale, on your bare metal, cloud or virtual machines.</p><h4 id=whats-the-workshop-about>What&rsquo;s the Workshop about</h4><p>The basics of Docker, how to use it, Networking, Data &ldquo;Management&rdquo; and <code>docker-compose</code>.
Orchestration tools like Kubernetes and/or RancherOS.</p><hr><h3 id=prepare-for-the-docker-madness>Prepare for the Docker Madness</h3><h4 id=side-notes>Side Notes</h4><ul><li>You can install Docker directly on your system or in a VirtualBox. If you use a VirtualBox, please use Fedora 23, as the OS.</li><li>If you are a Windows or Mac OSX user, ask yourself &ldquo;Why you use it?&rdquo;, switch to linux, thanks! You can use <a href=http://boot2docker.io/>Boot2Docker</a> (I don&rsquo;t help or give any support if you use it though!).</li><li>The download and login details to the VM are located <a href=#special-details>here</a>.</li></ul><h4 id=system-requirements>System &ldquo;Requirements&rdquo;</h4><ul><li>Linux Kernel 4.x or higher (&ldquo;included&rdquo; in the Virtualbox)</li></ul><h4 id=preparation>Preparation</h4><blockquote><p><strong>TASK</strong>: <code>setup101</code></p></blockquote><h5 id=docker-installation>Docker Installation</h5><p>For Docker see the begining of script at <a href=https://get.docker.com/>here</a> or run the installation command <code>curl -sSL https://get.docker.com/ | sh</code>.</p><h5 id=docker-compose-installation>docker-compose Installation</h5><center>![docker-compose Logo](docker-compose-logo.png)</center><p>For <code>docker-compose</code> see the <a href=https://docs.docker.com/compose/install/>docs</a> or run the following command:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#44475a>curl -L https://github.com/docker/compose/releases/download/1.6.2/docker-compose-`uname -s`-`uname -m` &gt; /usr/local/bin/docker-compose
</span></span></span><span style=display:flex><span><span style=color:#44475a>chmod +x /usr/local/bin/docker-compose
</span></span></span></code></pre></div><h5 id=last-but-not-least><strong>Last but not least</strong></h5><p>Clone the Workshop repo <code>https://github.com/galexrt/workshop-docker.git</code>, it&rsquo;ll provide all files used in the Workshop ;)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#44475a>git clone https://github.com/galexrt/workshop-docker.git
</span></span></span></code></pre></div><h4 id=test-your-installation>Test your installation</h4><p>If you installed Docker correctly, you have to add yourself to the <code>docker</code> group. Relog or restart your machine.
To verify that Docker is working, run the <code>hello-world</code> image as a test (<code> hello-world</code>):</p><blockquote><p><strong>Expected Output of <code>docker run hello-world</code></strong>
<img src=docker-run-hello-world.png alt="Output: docker run hello-world"></p></blockquote><p>To see if <code>docker-compose</code> got installed correctly, run <code>docker-compose --version</code>:</p><blockquote><p><strong>Expected Output of <code>docker-compose --version</code></strong>
<img src=docker-compose-version-output.png alt="Output: docker-compose &ndash;version"></p></blockquote><p>Everything seems right and working correctly? Move on to the next part.</p><hr><h3 id=everything-working-good-lets-go>Everything working? Good, let&rsquo;s go!</h3><h4 id=the-first-simple-task>The first simple Task</h4><blockquote><p><strong>TASK</strong>: <code>runit101</code></p></blockquote><p>Let&rsquo;s start with something simple, the situation is that you want to run a WordPress Blog and a MySQL (in this case we use MariaDB) database.
No problem, Docker got you!</p><h4 id=start-the-database-container-using-image-sameersbnmysqllatest>Start the database container (using image: sameersbn/mysql:latest):</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#44475a>docker run \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    --name mysql \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    -d \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    -e &#39;DB_NAME=wordpress&#39; \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    -e &#39;DB_USER=wordpress&#39; \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    -e &#39;DB_PASS=wordpress&#39; \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    sameersbn/mysql:latest
</span></span></span></code></pre></div><blockquote><p><strong>WDWD</strong></p><ul><li><code>docker</code> - Execute <code>docker</code> command.</li><li><code>run</code> - Run a container with the given configuration.</li><li><code>--name mysql</code> - Gives the container a name</li><li><code>-d</code> - Runs the container detached from the current session (don&rsquo;t attach stdin and stdout), the contrary is <code>-i</code> which attaches the stdin and stdout.</li><li><code>-e 'KEY=VALUE'</code> - Defines an environment variable inside the container at &ldquo;runtime&rdquo;.</li><li><code>sameersbn/mysql:latest</code> - The name of the image used.</li></ul></blockquote><h4 id=now-we-need-wordpress>Now we need WordPress</h4><p>The command for starting a WordPress instance is:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#44475a>docker run \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    --name wordpress \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    -d \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    --link mysql:database \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    -p 8080:80 \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    -e &#39;WORDPRESS_DB_HOST=mysql:3306&#39; \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    -e &#39;WORDPRESS_DB_NAME=wordpress&#39; \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    -e &#39;WORDPRESS_DB_USER=wordpress&#39; \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    -e &#39;WORDPRESS_DB_PASSWORD=wordpress&#39; \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    -e &#39;WORDPRESS_AUTH_KEY=SECURE_AUTH_KEY&#39; \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    -e &#39;WORDPRESS_LOGGED_IN_KEY=SECURE_LOGGED_IN_KEY&#39; \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    -e &#39;WORDPRESS_AUTH_SALT=SECURE_AUTH_SALT&#39; \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    -e &#39;WORDPRESS_LOGGED_IN_SALT=SECURE_LOGGED_IN_SALT&#39; \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    wordpress
</span></span></span></code></pre></div><blockquote><p><strong>WDWD</strong></p><ul><li><code>-p HOST_PORT:CONTAINER_PORT/tcp</code> - Creates a tcp (or udp) proxy on the <code>HOST_PORT</code> to the <code>CONTAINER_PORT</code></li></ul></blockquote><p>Enter the WordPress container using <code>docker exec</code>. With <code>docker exec</code> you can execute a command or a shell inside the container, but be aware that the shell and or command has to be present inside the container to be executed.</p><p><strong>But wait</strong> how does the WordPress instance talk to the database, when the database and WordPress are running in seperate containers?
Every container has a seperate container IP. Docker offers a simple way to allow these containers to speak to each other, by using <strong>links</strong>.</p><p>To create a link between two containers, not much is needed, just adding the <em>link</em> argument <code>--link=CONTAINER_ID:LINK_NAME</code> (<code>CONTAINER_ID</code> can be the id or the name; <code>LINK_NAME</code> is the usable &ldquo;hostname&rdquo; and prefix for environment variables.</p><p>When you link a container, the <em>environment variables</em> of the linked container will become available in the created container.
The &ldquo;inherited&rdquo; environment variables will be prefixed with the <code>LINK_NAME</code>, example link name is database <code>DATABASE_ENV_DB_USER</code> and so on.</p><p>But wait how can the containers communicate with each other and how does the created WordPress container know what IP address the database container has? See in the next part.</p><h4 id=summary>Summary</h4><p>We now can start a database and WordPress container.
We now know how to define environment variables, publish ports, link containers together.</p><hr><h3 id=how-can-the-containers-talk-local-and-multi-host>How can the containers talk? Local and multi host?</h3><blockquote><p><strong>TIP</strong></p><p>Use <a href=https://www.weave.works/>WeaveScope</a> to visualize your Docker network.</p><p><strong>TASK</strong> <code>network101</code>, file <code>start_weave_scope.sh</code>: Starts WeaveScope</p><p><strong>Example output</strong>
<img src=weavescope_ui.png alt="WeaveScope UI"></p></blockquote><h4 id=overview-over-possible-docker-networking-solutions>Overview over possible Docker networking &ldquo;solutions&rdquo;</h4><p><strong>How would one connect..</strong></p><ul><li>single host Docker installation<ul><li>Default Docker networking (<code>ICC</code> - Inter-Container-Communication)</li><li><a href=http://openvswitch.org/>OpenVSwitch</a></li></ul></li><li>multi host Docker installation (using overlay networks)<ul><li>Docker Machine/Engine &ldquo;Native&rdquo; Networking</li><li><a href=https://github.com/coreos/flannel>Flanneld</a></li><li><a href=https://www.weave.works/>Weave</a></li><li><a href=https://www.projectcalico.org/>Project Calico</a></li></ul></li></ul><p><strong>Now enough</strong> about Docker networking solutions, back to the topic.</p><h4 id=how-does-the-traffic-flow-in-and-out-of-containers>How does the traffic flow in and out of containers?</h4><p>We are now going to find out how the traffic flows when it enters and exits the container(s).
So we use the following tools, to check the traffic:</p><ul><li><code>ip link show</code> (<em>DON&rsquo;T you dare use <code>ifconfig</code>!</em>)</li><li><code>iptables</code> or <code>iptables-save</code></li></ul><blockquote><p><strong>TASK</strong>: <code>network101</code>, file: <code>show_me_dat_network.sh</code></p></blockquote><p>Let&rsquo;s see if Docker creates some type of network device for our database and WordPress container using <code>ip link show</code>:</p><blockquote><p><strong>Expected Output of <code>ip link show</code></strong>
<img src=docker-ip-link-show-output.png alt="Output: iptables output"></p></blockquote><p>Docker creates a bridge device called <code>docker0</code> and for every container, running in default network mode, it creates one veth interface per container and every veth interface get&rsquo;s an IP address from a specified pool. This IP address pool can be specified when starting Docker/the Docker Engine.</p><p>Now we know that because of every container having it&rsquo;s own &ldquo;dedicated&rdquo; IP, Docker uses NAT (Network Address Translation). Meaning we need more than just a separate interface per container. That means there has to be some sort of &ldquo;routing&rdquo; &ldquo;process&rdquo;. Let&rsquo;s check the iptables.</p><p>Are there any iptables rules added by Docker?:</p><blockquote><p><strong>Expected Output of <code>iptables -L</code> and <code>iptables -t nat -L</code></strong>
<img src=docker-iptables-output.png alt="Output: iptables output"></p></blockquote><p>As we can see, Docker creates iptables rules to route the NAT traffic to and from the containers.</p><p>Docker has an userspace proxy, the &ldquo;proxy&rdquo; is required so the ports that are published/forwarded can&rsquo;t be used twice or more.
Cause iptables can&rsquo;t &ldquo;block&rdquo; a port from being used multiple times, that&rsquo;s why there is this userspace proxy in place.</p><p>So if we start a container with published port <code>80</code> and then start another container also with port <code>80</code> published, the second container can&rsquo;t start. The second container would &ldquo;crash&rdquo; with the message that the port <code>80</code> is already in use. Cause the userspace proxy of the first container, has the port in use (/ &ldquo;blocks&rdquo; the port).</p><blockquote><p><strong>TIP</strong></p><p>Keep in mind, that default Docker networking works using NAT with iptables.
It is important, if you have other iptables rules, that are in place to filter incoming traffic, because Docker traffic goes through the <code>FORWARD</code>-Chain and not the <code>INPUT</code>-Chain!</p></blockquote><h4 id=summary-1>Summary</h4><p>Docker creates a iptables chain in nat and filter table. Docker creates a bridge interface called <code>docker0</code>. Every container has it&rsquo;s own veth interface.</p><h4 id=pointers-tuts-and-docs>Pointers, Tuts and Docs</h4><ul><li><a href=https://docs.docker.com/engine/userguide/networking/dockernetworks/>Dockernetworks Doc</a></li><li><a href=https://docs.docker.com/engine/userguide/networking/get-started-overlay/>Docker Native Overlay Network</a></li><li><a href=https://github.com/weaveworks/scope#getting-started>WeaveScope Getting started</a></li><li><a href=https://github.com/coreos/flannel>Flanneld</a></li></ul><hr><h3 id=data-and-layer-cakes-in-docker>Data and Layer Cakes in Docker</h3><h4 id=data-in-containers>Data in Containers</h4><blockquote><p><strong>TASK</strong>: <code>datait101</code></p></blockquote><p>Data is not persistent in containers. Currently if we stop the database container and delete it, all data is gone. :(
To make data in a container persistent, we use <em>volumes</em>. So to make our database data persistent, we add the following argument to the command.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#44475a>docker run \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    --name mysql \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    -d \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    -e &#39;DB_NAME=wordpress&#39; \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    -e &#39;DB_USER=wordpress&#39; \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    -e &#39;DB_PASS=wordpress&#39; \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    -v /opt/docker/database:/var/lib/mysql:rw \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    sameersbn/mysql:latest
</span></span></span></code></pre></div><blockquote><p><strong>WDWD</strong></p><ul><li><code>-v HOST_PATH:CONTAINER_PATH:rw</code> - <code>HOST_PATH</code> path to mount from the host into the container at the <code>CONTAINER_PATH</code>. <code>rw</code> means <code>read-write</code> and <code>ro</code> (<code>read-only</code>) are possible arguments too (default is <code>rw</code>).</li></ul></blockquote><p>We have to stop the WordPress container first, because it is linked to the database container:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#44475a>docker stop wordpress database
</span></span></span><span style=display:flex><span><span style=color:#44475a>docker rm wordpress database
</span></span></span></code></pre></div><p>Now you can start the database container and the WordPress container again.</p><h4 id=what-have-layer-cakes-to-do-with-docker-images>What have Layer Cakes to do with Docker Images?</h4><center>![Layer Cake from Wikimedia](layer-cake-from-wikimedia.png)
_Mhh, tasty, isn't it?_ But now back to the topic.</center><br><blockquote><p><strong>TASK</strong>: <code>dockerfile101</code></p></blockquote><p>In the Docker universe, a cake would be built from the bottom using a baseimage (or any other image as a base).
Every &ldquo;new&rdquo; layer on top of it, is an action that had been run when building the image.</p><p>Meaning if we create an image from the &ldquo;baseimage&rdquo; <code>fedora:23</code> like the example <code>Dockerfile</code>, a cross-section/profile would look like this:</p><center>![Docker Dockerfile Layers](docker-data-dockerfile-layers.png)</center><p>That is one of the reasons, why Docker images are so small. If you download 10 images that are based on <code>debian:jessie</code>, you would only have to download the created/modified layers, because the baseimage is the same in this case.</p><h4 id=pointers-tuts-and-docs-1>Pointers, Tuts and Docs</h4><ul><li><a href=https://docs.docker.com/engine/userguide/containers/dockervolumes/>Docker Volumes Docs</a></li><li><a href=https://clusterhq.com/flocker/introduction/>Flocker</a></li></ul><hr><h3 id=take-an-image---create-your-first-docker-image>Take an image! - Create your first Docker image</h3><p>Let&rsquo;s set our goal to creating a simple nginx container. We use <code>debian:jessie</code> as the baseimage.</p><h4 id=a-dockerfile>A <code>Dockerfile</code></h4><p>As you may have already seen in task <code>dockerfil101</code>, there was a file called <code>Dockerfile</code>.
A <code>Dockerfile</code> contains build instructions for an image. For <code>Dockerfile</code>s there is a &ldquo;special&rdquo; syntax, but the syntax is very simple.</p><blockquote><p><strong>Simple Dockerfile Example</strong> (Taken from the <a href=https://github.com/carazzim0/docker-ebot>carazzim0/docker-ebot</a> <code>Dockerfile</code>):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console></code></pre></div></blockquote><p>FROM debian:jessie</p><p>ENV EBOT_HOME="/ebot" TIMEZONE=&ldquo;Europe/Berlin&rdquo;</p><p>ADD entrypoint.sh /sbin/entrypoint.sh</p><p>RUN apt-get update &&<br>apt-get -y upgrade &&<br>apt-get clean &&<br>apt-get -y install nodejs npm curl git php5-cli php5-mysql screen git &&<br>apt-get clean &&<br>sed -i &ldquo;s~;date.timezone =~date.timezone = $TIMEZONE~g&rdquo; /etc/php5/cli/php.ini &&<br>/bin/ln -s /usr/bin/nodejs /usr/bin/node &&<br>curl -sS <a href=https://getcomposer.org/installer>https://getcomposer.org/installer</a> | php &ndash; &ndash;install-dir=/usr/bin &&<br>mkdir &ldquo;$EBOT_HOME&rdquo; &&<br>git clone <a href=https://github.com/deStrO/eBot-CSGO.git>https://github.com/deStrO/eBot-CSGO.git</a> &ldquo;$EBOT_HOME&rdquo; &&<br>cd &ldquo;$EBOT_HOME&rdquo; &&<br>git checkout &ldquo;master&rdquo; &&<br>/usr/bin/php /usr/bin/composer.phar install &&<br>npm install socket.io formidable archiver</p><p>COPY Match.php $EBOT_HOME/src/eBot/Match/Match.php</p><p>VOLUME ["$EBOT_HOME/demos", &ldquo;$EBOT_HOME/logs&rdquo;]</p><p>EXPOSE 12360 12361</p><p>ENTRYPOINT ["/sbin/entrypoint.sh"]</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#ff79c6>&gt;</span> <span style=color:#ff79c6>**</span>Advanced Dockerfile Example<span style=color:#ff79c6>**</span> (Taken <span style=color:#ff79c6>from</span> the [galexrt<span style=color:#ff79c6>/</span>docker<span style=color:#ff79c6>-</span>zulip](https:<span style=color:#ff79c6>//</span>github.com<span style=color:#ff79c6>/</span>galexrt<span style=color:#ff79c6>/</span>docker<span style=color:#ff79c6>-</span>zulip) <span style=color:#ff79c6>`</span>Dockerfile<span style=color:#ff79c6>`</span>):
</span></span><span style=display:flex><span><span style=color:#ff79c6>&gt;</span> <span style=color:#ff79c6>```</span>console
</span></span><span style=display:flex><span><span style=color:#ff79c6>FROM</span> quay.io<span style=color:#ff79c6>/</span>sameersbn<span style=color:#ff79c6>/</span>ubuntu:latest
</span></span><span style=display:flex><span>MAINTAINER Alexander Trost <span style=color:#ff79c6>&lt;</span>galexrt<span style=color:#ff79c6>@</span>googlemail.com<span style=color:#ff79c6>&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>ENV ZULIP_VERSION<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;master&#34;</span> DATA_DIR<span style=color:#ff79c6>=</span><span style=color:#f1fa8c>&#34;/data&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>ADD</span> entrypoint.sh <span style=color:#ff79c6>/</span>sbin<span style=color:#ff79c6>/</span>entrypoint.sh
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>RUN apt<span style=color:#ff79c6>-</span>get <span style=color:#ff79c6>-</span>q <span style=color:#ff79c6>update</span> <span style=color:#ff79c6>&amp;&amp;</span> \
</span></span><span style=display:flex><span>    apt<span style=color:#ff79c6>-</span>get <span style=color:#ff79c6>-</span>q dist<span style=color:#ff79c6>-</span>upgrade <span style=color:#ff79c6>-</span>y <span style=color:#ff79c6>&amp;&amp;</span> \
</span></span><span style=display:flex><span>    apt<span style=color:#ff79c6>-</span>get install <span style=color:#ff79c6>-</span>y git <span style=color:#ff79c6>&amp;&amp;</span> \
</span></span><span style=display:flex><span>    mkdir <span style=color:#ff79c6>-</span>p <span style=color:#f1fa8c>&#34;$DATA_DIR&#34;</span> <span style=color:#ff79c6>/</span>root<span style=color:#ff79c6>/</span>zulip <span style=color:#ff79c6>&amp;&amp;</span> \
</span></span><span style=display:flex><span>    git clone https:<span style=color:#ff79c6>//</span>github.com<span style=color:#ff79c6>/</span>zulip<span style=color:#ff79c6>/</span>zulip.git <span style=color:#ff79c6>/</span>root<span style=color:#ff79c6>/</span>zulip <span style=color:#ff79c6>&amp;&amp;</span> \
</span></span><span style=display:flex><span>    cd <span style=color:#ff79c6>/</span>root<span style=color:#ff79c6>/</span>zulip <span style=color:#ff79c6>&amp;&amp;</span> \
</span></span><span style=display:flex><span>    git checkout <span style=color:#f1fa8c>&#34;$ZULIP_VERSION&#34;</span> <span style=color:#ff79c6>&amp;&amp;</span> \
</span></span><span style=display:flex><span>    rm <span style=color:#ff79c6>-</span>rf <span style=color:#ff79c6>/</span>root<span style=color:#ff79c6>/</span>zulip<span style=color:#ff79c6>/</span>.git
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>ADD</span> custom_zulip_files<span style=color:#ff79c6>/</span> <span style=color:#ff79c6>/</span>root<span style=color:#ff79c6>/</span>custom_zulip
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>RUN cp <span style=color:#ff79c6>-</span>rf <span style=color:#ff79c6>/</span>root<span style=color:#ff79c6>/</span>custom_zulip<span style=color:#6272a4>/* /root/zulip &amp;&amp; \
</span></span></span><span style=display:flex><span><span style=color:#6272a4>    VOYAGER_CLASS=&#34;dockervoyager&#34; DEPLOYMENT_TYPE=&#34;dockervoyager&#34; ADDITIONAL_PACKAGES=&#34;python-dev python-six python-pbs&#34; \
</span></span></span><span style=display:flex><span><span style=color:#6272a4>    /root/zulip/scripts/setup/install &amp;&amp; \
</span></span></span><span style=display:flex><span><span style=color:#6272a4>    wget -q https://www.zulip.com/dist/releases/zulip-server-latest.tar.gz -O /tmp/zulip-server.tar.gz &amp;&amp; \
</span></span></span><span style=display:flex><span><span style=color:#6272a4>    tar xfz /tmp/zulip-server.tar.gz -C &#34;/home/zulip/prod-static&#34; --strip-components=3 --wildcards */</span>prod<span style=color:#ff79c6>-</span>static<span style=color:#ff79c6>/</span>serve <span style=color:#ff79c6>&amp;&amp;</span> \
</span></span><span style=display:flex><span>    rm <span style=color:#ff79c6>-</span>rf <span style=color:#ff79c6>/</span>tmp<span style=color:#ff79c6>/</span>zulip<span style=color:#ff79c6>-</span>server.tar.gz <span style=color:#ff79c6>&amp;&amp;</span> \
</span></span><span style=display:flex><span>    ln <span style=color:#ff79c6>-</span>nsf <span style=color:#ff79c6>/</span>home<span style=color:#ff79c6>/</span>zulip<span style=color:#ff79c6>/</span>deployments<span style=color:#ff79c6>/</span>current<span style=color:#ff79c6>/</span>prod<span style=color:#ff79c6>-</span>static<span style=color:#ff79c6>/</span>serve <span style=color:#ff79c6>/</span>home<span style=color:#ff79c6>/</span>zulip<span style=color:#ff79c6>/</span>prod<span style=color:#ff79c6>-</span>static <span style=color:#ff79c6>&amp;&amp;</span> \
</span></span><span style=display:flex><span>    apt<span style=color:#ff79c6>-</span>get <span style=color:#ff79c6>-</span>qq autoremove <span style=color:#ff79c6>--</span><span style=color:#ff79c6>purge</span> <span style=color:#ff79c6>-</span>y <span style=color:#ff79c6>&amp;&amp;</span> \
</span></span><span style=display:flex><span>    apt<span style=color:#ff79c6>-</span>get <span style=color:#ff79c6>-</span>qq clean <span style=color:#ff79c6>&amp;&amp;</span> \
</span></span><span style=display:flex><span>    rm <span style=color:#ff79c6>-</span>rf <span style=color:#ff79c6>/</span>root<span style=color:#ff79c6>/</span>zulip<span style=color:#ff79c6>/</span>puppet<span style=color:#ff79c6>/</span> <span style=color:#ff79c6>/</span>var<span style=color:#ff79c6>/</span>lib<span style=color:#ff79c6>/</span>apt<span style=color:#ff79c6>/</span>lists<span style=color:#6272a4>/* /tmp/* /var/tmp/*
</span></span></span><span style=display:flex><span><span style=color:#6272a4>
</span></span></span><span style=display:flex><span><span style=color:#6272a4>ADD setup_files/ /opt/files
</span></span></span><span style=display:flex><span><span style=color:#6272a4>ADD includes/supervisor/conf.d/zulip_postsetup.conf /etc/supervisor/conf.d/zulip_postsetup.conf
</span></span></span><span style=display:flex><span><span style=color:#6272a4>ADD includes/createZulipAdmin.sh /createZulipAdmin.sh
</span></span></span><span style=display:flex><span><span style=color:#6272a4>
</span></span></span><span style=display:flex><span><span style=color:#6272a4>VOLUME [&#34;$DATA_DIR&#34;]
</span></span></span><span style=display:flex><span><span style=color:#6272a4>EXPOSE 80 443
</span></span></span><span style=display:flex><span><span style=color:#6272a4>
</span></span></span><span style=display:flex><span><span style=color:#6272a4>ENTRYPOINT [&#34;/sbin/entrypoint.sh&#34;]
</span></span></span><span style=display:flex><span><span style=color:#6272a4>CMD [&#34;app:run&#34;]
</span></span></span></code></pre></div><p><strong>Don&rsquo;t worry</strong> we&rsquo;re just making a very simple and basic example. ;)</p><h4 id=dockerfile-explained><code>Dockerfile</code> explained</h4><blockquote><p><strong>TASK</strong>: <code>dockerfile202</code></p><p><strong>TIP</strong></p><p>If you have trouble writing a <code>Dockerfile</code>, check the <a href=https://docs.docker.com/engine/reference/builder/>Dockerfile Docs</a>.</p></blockquote><p>You will create an image with <code>nginx</code> installed (You can later expand it, with more functionality, like with PHP-FPM).
To guide you in creating a nginx image, I show you an example http webserver written in golang as an example, before we create the &ldquo;final&rdquo; <code>nginx</code> image.</p><blockquote><p><strong>Golang Dockerfile Example</strong>: (Example taken from <a href=https://medium.com/@shijuvar/deploying-go-web-apps-with-docker-1b7561b36f53#.lkj19wklp>Shiju Varghese Medium Blog</a>)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console></code></pre></div></blockquote><h1 id=golang-image-where-workspace-gopath-configured-at-go>golang image where workspace (GOPATH) configured at /go.</h1><p>FROM golang:latest</p><h1 id=copy-the-local-package-files-to-the-containers-workspace>Copy the local package files to the container’s workspace.</h1><p>ADD . /go/src/github.com/shijuvar/golang-docker</p><h1 id=build-the-golang-docker-command-inside-the-container>Build the golang-docker command inside the container.</h1><p>RUN go install github.com/shijuvar/golang-docker</p><h1 id=run-the-golang-docker-command-when-the-container-starts>Run the golang-docker command when the container starts.</h1><p>ENTRYPOINT ["/go/bin/golang-docker"]</p><h1 id=http-server-listens-on-port-8080>http server listens on port 8080.</h1><p>EXPOSE 8080</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-mysql data-lang=mysql><span style=display:flex><span><span style=color:#ff79c6>&gt;</span> <span style=color:#ff79c6>**</span>WDWD<span style=color:#ff79c6>**</span>
</span></span><span style=display:flex><span><span style=color:#ff79c6>&gt;</span> <span style=color:#ff79c6>*</span> <span style=color:#ff79c6>`</span><span style=color:#ff79c6>FROM</span> ...<span style=color:#ff79c6>`</span> <span style=color:#ff79c6>-</span> Sets the baseimage.
</span></span><span style=display:flex><span><span style=color:#ff79c6>&gt;</span> <span style=color:#ff79c6>*</span> <span style=color:#ff79c6>`</span>COPY ... ...<span style=color:#ff79c6>`</span> <span style=color:#ff79c6>-</span> Copy files <span style=color:#ff79c6>from</span> the build root.
</span></span><span style=display:flex><span><span style=color:#ff79c6>&gt;</span> <span style=color:#ff79c6>*</span> <span style=color:#ff79c6>`</span><span style=color:#ff79c6>ADD</span> ... ...<span style=color:#ff79c6>`</span> <span style=color:#ff79c6>-</span> Same <span style=color:#ff79c6>as</span> <span style=color:#ff79c6>`</span>COPY<span style=color:#ff79c6>`</span>, but target can be <span style=color:#f1fa8c>&#34;online&#34;</span> <span style=color:#ff79c6>and</span> <span style=color:#ff79c6>if</span> it <span style=color:#ff79c6>is</span> an archive, it will be extracted.
</span></span><span style=display:flex><span><span style=color:#ff79c6>&gt;</span> <span style=color:#ff79c6>*</span> <span style=color:#ff79c6>`</span>RUN ...<span style=color:#ff79c6>`</span> <span style=color:#ff79c6>-</span> Run <span style=color:#50fa7b>commands</span> (Shell used <span style=color:#ff79c6>`/</span>bin<span style=color:#ff79c6>/</span>sh<span style=color:#ff79c6>`</span>).
</span></span><span style=display:flex><span><span style=color:#ff79c6>&gt;</span> <span style=color:#ff79c6>*</span> <span style=color:#ff79c6>`</span>ENTRYPOINT [<span style=color:#f1fa8c>&#34;...&#34;</span>]<span style=color:#ff79c6>`</span> <span style=color:#ff79c6>-</span> The command <span style=color:#ff79c6>to</span> execute <span style=color:#ff79c6>when</span> the container <span style=color:#ff79c6>is</span> started.
</span></span><span style=display:flex><span><span style=color:#ff79c6>&gt;</span> <span style=color:#ff79c6>*</span> <span style=color:#ff79c6>`</span>CMD [<span style=color:#f1fa8c>&#34;...&#34;</span>]<span style=color:#ff79c6>`</span> <span style=color:#ff79c6>-</span> Arguments <span style=color:#ff79c6>for</span> the <span style=color:#ff79c6>`</span>ENTRYPOINT<span style=color:#ff79c6>`</span>.
</span></span><span style=display:flex><span><span style=color:#ff79c6>&gt;</span> <span style=color:#ff79c6>*</span> <span style=color:#ff79c6>`</span>EXPOSE <span style=color:#bd93f9>8080</span> ...<span style=color:#ff79c6>`</span> <span style=color:#ff79c6>-</span> Expose a port <span style=color:#ff79c6>when</span> <span style=color:#50fa7b>linked</span> (_If <span style=color:#ff79c6>not</span> specified port <span style=color:#ff79c6>not</span> reachable <span style=color:#ff79c6>when</span> linked<span style=color:#ff79c6>!</span>_).
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>There<span style=color:#f1fa8c>&#39;s even the possibility, to execute specific commands when the image is used as a base image, the instruction is called `ONBUILD ...`.
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>To build your image we use the `docker build` command. Building the example image run the following command:
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>```console
</span></span></span><span style=display:flex><span><span style=color:#f1fa8c>docker build -t golang-docker -f Dockerfile .
</span></span></span></code></pre></div><blockquote><p><strong>WDWD</strong></p><ul><li><code>build</code> - Used to build Docker images.</li><li><code>-t TAG_NAME</code> - Specify the tag / name of the image, you are creating (Optional. <strong>Important</strong> when manually building and pushing a Docker image).</li><li><code>-f DOCKERFILE</code> - Set the location of the <code>Dockerfile</code> (Optional).</li><li><code>PATH</code> - The root of the image build (<strong>Important</strong> when <code>ADD</code> or <code>COPY</code> is used in the <code>Dockerfile</code>).</li></ul></blockquote><p>As you can see, it isn&rsquo;t hard to build your first Docker images.
If you want to see more advanced examples, you can find more examples in my GitHub repositories <a href="https://github.com/search?q=user%3AGalexrt+docker-">here</a>.</p><h4 id=creating-the-nginx-image>Creating the <code>nginx</code> image</h4><p>Now that we know some <code>Dockerfile</code> basics, we can start building our own <code>nginx</code> image from the baseimage <code>debian:jessie</code>.</p><p>Let&rsquo;s make this like a test in the school, replace all <code>__BLANK__</code> with the correct answer (Solutions are <a href=#For-the-nginx-Dockerfile>here</a>):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#44475a>FROM __BLANK__
</span></span></span><span style=display:flex><span><span style=color:#44475a></span>
</span></span><span style=display:flex><span><span style=color:#44475a>RUN __BLANK__
</span></span></span><span style=display:flex><span><span style=color:#44475a></span>
</span></span><span style=display:flex><span><span style=color:#44475a>ENTRYPOINT [&#34;__BLANK__&#34;]
</span></span></span></code></pre></div><p>Got all blanks filled out? Good. Let&rsquo;s build the image:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#44475a>docker build -t workshop-nginx .
</span></span></span></code></pre></div><blockquote><p><strong>Expected Output of <code>docker build -t workshop-nginx .</code></strong>
<img src=docker-build-nginx-image.png alt="Docker Build workshop-nginx image"></p></blockquote><p>The build should go successfully, when you filled in the blanks correctly. Let&rsquo;s run the image to see if it is working, the container name will be <code>nginx-workshop</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#44475a>docker run \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    --name nginx-workshop \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    -d \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    -p 80:80 \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    workshop-nginx
</span></span></span></code></pre></div><p>If you did something wrong, remove the container using (where <code>CONTAINER_NAME</code> is a container ID or name):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#44475a>docker rm CONTAINER_NAME
</span></span></span></code></pre></div><p>To check if the container is running with your image, run <code>docker ps -a</code>.</p><blockquote><p><strong>WDWD</strong></p><ul><li><code>ps</code> - Like the <code>ps </code>command, but for the containers.</li><li><code>-a</code> - Show all containers, whether their current state, without it showing only running containers.</li></ul></blockquote><p>You should see that the container you started, has exited.
There&rsquo;s a simple reason, why the container exited/stopped. When running a command as the entrypoint, it has to stay running, not fork to background. When the process forks to background, Docker will think the process has stopped and the container status will be set to <code>exited</code> with the last return code.</p><p>That&rsquo;s why we need to tell <code>nginx</code>, not to run as a daemon, not fork to background, with the following additional arguments <code>"-g", "daemon off;"</code> (these arguments must be added to the <code>ENTRYPOINT</code> line of the <code>Dockerfile</code>).</p><p>So we could make a change to the <code>nginx.conf</code>, overwrite <code>nginx.conf</code> with a custom one or <strong>just change</strong> the <code>ENTRYPOINT</code> line to make it look like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#44475a>ENTRYPOINT [&#34;nginx&#34;, &#34;-g&#34;, &#34;daemon off;&#34;]
</span></span></span></code></pre></div><p>Let&rsquo;s rebuild the image (same command) and run it again. Open <a href=http://127.0.0.1:8080>http://127.0.0.1:8080</a> in your browser and voilà it should show the nginx default page.</p><p>To go further with your created image, let&rsquo;s &ldquo;mount&rdquo; a volume inside the container with our own <code>index.html</code>.
Use the <code>index.html</code> from task <code>dockerfile202</code> or create one yourself.</p><p>Now we add a volume to the container. Add <code>-v "$(pwd)":"/usr/share/nginx/html"</code> to the <code>docker run</code> command, but don&rsquo;t forget add the argument before the image name.
Your command should look like this:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#44475a>docker run \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    --name workshop-nginx \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    -d \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    -p 8080:80 \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    -v &#34;$(pwd)&#34;:&#34;/usr/share/nginx/html&#34; \
</span></span></span><span style=display:flex><span><span style=color:#44475a>    workshop-nginx
</span></span></span></code></pre></div><p>This starts a container named <code>workshop-nginx</code> running the image <code>workshop-nginx</code> with a volume mounted at <code>/usr/share/nginx/html</code>.
If we now open <a href=http://127.0.0.1:8080>http://127.0.0.1:8080</a> in the browser, we will see our <code>index.html</code>. Well done!</p><h4 id=summary-2>Summary</h4><p>We have created our own working <code>nginx</code> image.
We are able to mount a folder into the container and see it&rsquo;s content per <code>nginx</code> web server.</p><h4 id=pointers-tuts-and-docs-2>Pointers, Tuts and Docs</h4><ul><li><a href=https://docs.docker.com/engine/reference/builder/>Dockerfile Docs</a></li><li><a href=https://www.digitalocean.com/community/tutorials/docker-explained-using-dockerfiles-to-automate-building-of-images>Digitialocean Docker explained: Dockerfiles to automate building of images</a></li><li><a href=http://crosbymichael.com/dockerfile-best-practices.html>Dockerfile Best Practices by Michael Crosby</a></li></ul><hr><h3 id=docker-composeyml-aka-simpleness-for-multi-container-applications>docker-compose.yml aka &ldquo;Simpleness for multi container applications&rdquo;</h3><h4 id=making-multi-container-applications-simpler-to-start>Making multi container applications simpler to start</h4><blockquote><p><strong>TASK</strong>: <code>compose101</code></p></blockquote><p>To remove the process of typing all those commands to start the containers, <code>docker-compose</code> has been created.
<code>docker-compose</code> makes it <em>easy peasy lemon squeezy</em> to run one to many containers using one command.
The syntax of a <code>docker-compose.yml</code> is YAML (<em>YAML Ain&rsquo;t Markup Language</em>). A good syntax checker, I use, is available <a href=https://yaml-online-parser.appspot.com/>here</a>.</p><p>In our example with WordPress we will create a <code>docker-compose.yml</code> for our database, WordPress and as an extra we&rsquo;ll add phpMyAdmin to it.</p><p>Create the <code>docker-compose.yml</code> file. I made this part like a test again, so you can see where you have knowledge holes, replace all <code>__BLANK__</code> with the correct answer (Solutions are <a href=#For-WordPress-docker-compose-yml>here</a>):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span># Taken from https://www.digitalocean.com/community/tutorials/how-to-install-wordpress-and-phpmyadmin-with-docker-compose-on-ubuntu-14-04
</span></span><span style=display:flex><span><span style=color:#44475a>database:
</span></span></span><span style=display:flex><span><span style=color:#44475a>  image: sameersbn/mysql:latest
</span></span></span><span style=display:flex><span><span style=color:#44475a>  environment:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    DB_NAME: wordpress
</span></span></span><span style=display:flex><span><span style=color:#44475a>    DB_USER: wordpress
</span></span></span><span style=display:flex><span><span style=color:#44475a>    DB_PASS: wordpress
</span></span></span><span style=display:flex><span><span style=color:#44475a>    DB_REMOTE_ROOT_NAME: root
</span></span></span><span style=display:flex><span><span style=color:#44475a>    DB_REMOTE_ROOT_PASS: workshop
</span></span></span><span style=display:flex><span><span style=color:#44475a>  volumes:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    - &#34;/opt/docker/database:/var/lib/mysql:rw&#34;
</span></span></span><span style=display:flex><span><span style=color:#44475a>wordpress:
</span></span></span><span style=display:flex><span><span style=color:#44475a>  image: wordpress
</span></span></span><span style=display:flex><span><span style=color:#44475a>  links:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    - __BLANK__:mysql
</span></span></span><span style=display:flex><span><span style=color:#44475a>  ports:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    - 8080:80
</span></span></span><span style=display:flex><span><span style=color:#44475a>  environment:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    WORDPRESS_DB_HOST: __BLANK__:3306
</span></span></span><span style=display:flex><span><span style=color:#44475a>    WORDPRESS_DB_NAME: __BLANK__
</span></span></span><span style=display:flex><span><span style=color:#44475a>    WORDPRESS_DB_USER: __BLANK__
</span></span></span><span style=display:flex><span><span style=color:#44475a>    WORDPRESS_DB_PASSWORD: __BLANK__
</span></span></span><span style=display:flex><span><span style=color:#44475a>    WORDPRESS_AUTH_KEY: SECURE_AUTH_KEY
</span></span></span><span style=display:flex><span><span style=color:#44475a>    WORDPRESS_LOGGED_IN_KEY: SECURE_LOGGED_IN_KEY
</span></span></span><span style=display:flex><span><span style=color:#44475a>    WORDPRESS_AUTH_SALT: SECURE_AUTH_SALT
</span></span></span><span style=display:flex><span><span style=color:#44475a>    WORDPRESS_LOGGED_IN_SALT: SECURE_LOGGED_IN_SALT
</span></span></span><span style=display:flex><span><span style=color:#44475a>phpmyadmin:
</span></span></span><span style=display:flex><span><span style=color:#44475a>  image: corbinu/docker-phpmyadmin
</span></span></span><span style=display:flex><span><span style=color:#44475a>  links:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    - __BLANK__:mysql
</span></span></span><span style=display:flex><span><span style=color:#44475a>  ports:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    - 8181:80
</span></span></span><span style=display:flex><span><span style=color:#44475a>  environment:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    MYSQL_USERNAME: root
</span></span></span><span style=display:flex><span><span style=color:#44475a>    MYSQL_ROOT_PASSWORD: wordpress
</span></span></span></code></pre></div><blockquote><p><strong>WDWD</strong></p><ul><li><code>database:</code> - Name of the container.</li><li><code>image:</code> - Defines the used image for the container.</li><li><code>links: []</code> - A list of container links.</li><li><code>ports: []</code> - A list of published ports.</li><li><code>environment: []</code> - &ldquo;Hash&rdquo; list of environment variables (Format: <code>NAME: VALUE</code>).</li></ul></blockquote><p>I have also added the environment variables <code>DB_REMOTE_ROOT_NAME</code> and <code>DB_REMOTE_ROOT_PASS</code>, so that phpMyAdmin can access the database.</p><h4 id=starting-our-multi-container-applications-with-one-command>Starting our multi container applications with one command</h4><p>To &ldquo;run&rdquo;/start our <code>docker-compose.yml</code>, we run:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#44475a>docker-compose up -f DOCKER_COMPOSE_YML
</span></span></span></code></pre></div><blockquote><p><strong>WDWD</strong></p><ul><li><code>-f DOCKER_COMPOSE_YML</code> - Optional. Default is <code>docker-compose.yml</code>.</li><li><code>up</code> - Starts the containers defined in the given docker-compose file.</li><li><code>stop</code> - Stops the containers defined in the given docker-compose file.</li><li><code>rm</code> - Deletes the containers defined in the given docker-compose file.</li></ul></blockquote><blockquote><p><strong>TIP</strong></p><p>Keep the <code>-f DOCKERFILE</code> argument in mind, when creating multiple <code>docker-compose.yml</code>&rsquo;s.</p></blockquote><h4 id=lets-do-more-with-docker-compose>Let&rsquo;s do more with <code>docker-compose</code>!</h4><blockquote><p><strong>TASK</strong>: <code>compose202</code>
The task contains other <code>docker-compose.yml</code>s for you to play around with. Look at the <code>docker-compose.yml</code>s and start them.
Just play around with <code>docker-compose</code> a bit.
<strong>And don&rsquo;t forget</strong> the <code>-f DOCKER_COMPOSE_YML</code> argument. ;)</p></blockquote><h4 id=summary-3>Summary</h4><p>We can now write basic <code>docker-compose.yml</code>s. We can now start a multi container application with one single command.</p><h4 id=pointers-tuts-and-docs-3>Pointers, Tuts and Docs</h4><ul><li><a href=https://docs.docker.com/compose/>Docker Compose Docs</a></li><li><a href=https://www.digitalocean.com/community/tutorials/how-to-install-and-use-docker-compose-on-ubuntu-14-04>Digitalocean Docker Compose Installation Guide</a></li></ul><hr><blockquote><p>Below this line, everythings a bit vague and still needs some writing to be done. Please be aware of that!
This line will slowly move down, until I&rsquo;m finished. ;)</p></blockquote><hr><blockquote><p><strong>Read this section carefully! This sections explain the basic principles of Kubernetes.</strong></p></blockquote><h3 id=kubessar---glossar>Kubessar - Glossar</h3><p>Like a glossar, but for Kubernetes.</p><ul><li>Pod - A set of one or more containers.</li><li>ReplicationController - Replication for Pods.</li><li>Services - Exposing Pod ports as a service (&ldquo;loadbalanced&rdquo;) to other pods.</li><li>Namespaces - Everything runs in a namespace.</li><li>ResourceQuotas - Quotas for &ldquo;everything&rdquo; in a namespace.</li><li>kubeclt Files - Run/&ldquo;Deployment&rdquo; files for the kubectl command.</li><li>&ldquo;Object&rdquo; - A Pod, ReplicationController, Service or Namespace. A &ldquo;part&rdquo; of the available ressources to use with the Kubernetes API.</li></ul><p>I highly recommend you to look through my Kubernetes presentation to get to know Kubernetes a bit before starting to work with it.
Keep in mind, the presentation is written in german.</p><iframe src="https://docs.google.com/presentation/d/1XHl6MlB0GE2rmoXbe5_603UFVkFF2S3ud6Uc0QI7fPo/embed?start=false&loop=true&delayms=5000" frameborder=0 width=960 height=569 allowfullscreen mozallowfullscreen=true webkitallowfullscreen=true></iframe><hr><h3 id=conductor-of-the-orchestra---kubernetes>Conductor of the orchestra - Kubernetes</h3><figure itemprop=associatedMedia itemscope itemtype=http://schema.org/ImageObject><a href=https://edenmal.moe/post/covers/kubernetes-logo-with-bg.png itemprop=contentUrl><img itemprop=thumbnail src=https://edenmal.moe/post/covers/kubernetes-logo-with-bg.png width=700px></a><figcaption><h4>Kubernetes Logo</h4></figcaption></figure><h4 id=side-notes-1>Side Notes</h4><ul><li>Certificates are &ldquo;hard&rdquo; to generate, I&rsquo;ll be using the kubernetes ansible cert creation script.</li></ul><h4 id=installing-ansible>Installing Ansible</h4><p><em>If you use the provided Virtual Box, this step is not needed!</em></p><blockquote><p>The package <code>python-netaddr</code> also needs to be installed on the client. Don&rsquo;t forget to install it!!</p></blockquote><p>Please refer to the official <a href=http://docs.ansible.com/ansible/intro_installation.html#installing-the-control-machine>Ansible Installation Docs</a> on how to install Ansible on your machine.</p><p>For ArchLinux: <a href=http://docs.ansible.com/ansible/intro_installation.html#latest-releases-via-pacman-arch-linux>http://docs.ansible.com/ansible/intro_installation.html#latest-releases-via-pacman-arch-linux</a>
For Debian: <a href=http://docs.ansible.com/ansible/intro_installation.html#latest-releases-via-apt-ubuntu>http://docs.ansible.com/ansible/intro_installation.html#latest-releases-via-apt-ubuntu</a>
For CentOS: <a href=http://docs.ansible.com/ansible/intro_installation.html#latest-release-via-yum>http://docs.ansible.com/ansible/intro_installation.html#latest-release-via-yum</a></p><h4 id=create-the-inventory-for-the-cluster>Create the inventory for the cluster</h4><blockquote><p><strong>TASK</strong>: <code>kubernetes101</code></p></blockquote><p>Enter the cloned repository and look out for a directory called <code>ansible/</code>.</p><p>Create a file called <code>inventory</code>, this file will contain the list of servers.
Per server one line in the format below (username and password are valid for the provided vm, change to suit your environment):</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#44475a>[masters]
</span></span></span><span style=display:flex><span><span style=color:#44475a></span># In most cases the first <span style=color:#f1fa8c>&#34;server&#34;</span>
</span></span><span style=display:flex><span><span style=color:#44475a>SERVER_IP_ADDRESS:SSH_PORT ansible_user=docker ansible_ssh_pass=docker ansible_become_pass=docker
</span></span></span><span style=display:flex><span><span style=color:#44475a></span>
</span></span><span style=display:flex><span><span style=color:#44475a>[etcd]
</span></span></span><span style=display:flex><span><span style=color:#44475a></span>#Add all the node servers here
</span></span><span style=display:flex><span><span style=color:#44475a>SERVER_IP_ADDRESS:SSH_PORT ansible_user=docker ansible_ssh_pass=docker ansible_become_pass=docker
</span></span></span><span style=display:flex><span><span style=color:#44475a>[...]
</span></span></span><span style=display:flex><span><span style=color:#44475a>SERVER_IP_ADDRESS:SSH_PORT ansible_user=docker ansible_ssh_pass=docker ansible_become_pass=docker
</span></span></span><span style=display:flex><span><span style=color:#44475a></span>
</span></span><span style=display:flex><span><span style=color:#44475a>[nodes]
</span></span></span><span style=display:flex><span><span style=color:#44475a></span># This can include the master server and the etcd servers too
</span></span><span style=display:flex><span><span style=color:#44475a>SERVER_IP_ADDRESS:SSH_PORT ansible_user=workshop ansible_ssh_pass=workshop ansible_become_pass=workshop
</span></span></span><span style=display:flex><span><span style=color:#44475a>[...]
</span></span></span><span style=display:flex><span><span style=color:#44475a>SERVER_IP_ADDRESS:SSH_PORT ansible_user=workshop ansible_ssh_pass=workshop ansible_become_pass=workshop
</span></span></span></code></pre></div><blockquote><p><strong>WDWD</strong></p><ul><li><code>[GROUP_NAME]</code> - Specifies a server/inventory group.</li><li><code>SERVER_IP_ADDRESS:SSH_PORT</code> - <code>SSH_PORT</code> is optional. A hostname or ip address the server is reachable.</li><li><code>ansible_user</code> - Specifies the SSH username to login with.</li><li><code>ansible_ssh_pass</code> - SSH user password.</li><li><code>ansible_become_pass</code> - The sudo (default) password.</li></ul></blockquote><p>If you have created your inventory properly, run <code>./setup.sh --syntax-check</code> to check for any syntax errors.</p><p>No syntax errors? Let&rsquo;s bring the cluster up!</p><h4 id=bringing-up-your-cluster-with-ansible>Bringing up your cluster with Ansible</h4><blockquote><p><strong>All the servers need to have python installed!</strong></p></blockquote><p>Before you continue to do anything, go to the task <code>kubernetes101</code> directory and execute the <code>prepare.sh</code> script. The script will download and setup all files required for the deployment of the cluster.</p><p>If the script exits with an error, please get in touch with me (It should normally not exit with an error).</p><p>Then navigate into the <code>kubernetes/contrib/ansible</code> directory, run <code>./setup.sh -vvvv </code>(the <code>-vvvv</code> are for verbose), this will setup all machines to your needings.</p><p>If a step fails (It shouldn&rsquo;t fail), try to fix it through <a href=http://lmgtfy.com/>MAGIC</a>, most problems are solved by just running the command again.</p><h4 id=summary-4>Summary</h4><p>We now have a working Kubernetes cluster (<strong>DON&rsquo;T use this setup in production!</strong> <em>There is more work required to make it secure for productions use.</em>).
We are now ready to deploy a WordPress with Mysql on it :)</p><h4 id=pointers-tuts-and-docs-4>Pointers, Tuts and Docs</h4><ul><li>Kubernetes<ul><li><strong>My favorite one</strong></li><li><a href=http://kubernetes.io/v1.1/basicstutorials.html>Kubernetes Basics</a></li><li>Storage &ldquo;Management&rdquo;</li><li>Service Loadbalancing (Kubernetes Style)</li><li>Uses a Key-Value Storage</li></ul></li><li>Docker Swarm<ul><li>Requires Docker Daemon to run on a network socket</li><li>Authentication using Certificates</li><li>Uses a Key-Value Storage</li></ul></li><li>Shipyard<ul><li>Simple setup</li></ul></li><li>Rancher<ul><li>Simple (non-https and non-ha) setup</li></ul></li></ul><h3 id=first-deployment-with-kubernetes>First Deployment with Kubernetes</h3><blockquote><p><strong>TASK</strong>: <code>kubernetes202</code></p></blockquote><h4 id=kubectl-files>kubectl Files</h4><p>kubectl files, as I call them, are written in YAML (<em>YAML Ain&rsquo;t Markup Language</em>) like <code>docker-compose.yml</code> files, but have some &ldquo;big&rdquo; differences.
Let&rsquo;s take a look at an example of a WordPress, Database and phpMyAdmin Pod and services.</p><p>These files are also located in the task directory and are here shown for people that haven&rsquo;t cloned the workshop repository.</p><blockquote><p><strong>WDWD</strong> comments are included in the code boxes.</p></blockquote><h5 id=wordpress>WordPress</h5><h6 id=pod>Pod</h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span># Kubernetes API version
</span></span><span style=display:flex><span><span style=color:#44475a>apiVersion: v1
</span></span></span><span style=display:flex><span><span style=color:#44475a></span># Type of <span style=color:#f1fa8c>&#34;request&#34;</span>
</span></span><span style=display:flex><span><span style=color:#44475a>kind: Pod
</span></span></span><span style=display:flex><span><span style=color:#44475a></span># Metadata of the <span style=color:#f1fa8c>&#34;object&#34;</span>
</span></span><span style=display:flex><span><span style=color:#44475a>metadata:
</span></span></span><span style=display:flex><span><span style=color:#44475a>  # Name of the &#34;object&#34;
</span></span></span><span style=display:flex><span><span style=color:#44475a>  name: wordpress
</span></span></span><span style=display:flex><span><span style=color:#44475a>  # Labels of the &#34;object&#34;
</span></span></span><span style=display:flex><span><span style=color:#44475a>  labels:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    # A lable named &#34;name&#34; with value &#34;wordpress&#34;
</span></span></span><span style=display:flex><span><span style=color:#44475a>    name: wordpress
</span></span></span><span style=display:flex><span><span style=color:#44475a></span># spec ~<span style=color:#ff79c6>=</span> Specifications of the <span style=color:#f1fa8c>&#34;object&#34;</span>
</span></span><span style=display:flex><span><span style=color:#44475a>spec:
</span></span></span><span style=display:flex><span><span style=color:#44475a>  # List of Container definitions
</span></span></span><span style=display:flex><span><span style=color:#44475a>  containers:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    # What Docker image to use
</span></span></span><span style=display:flex><span><span style=color:#44475a>    - image: wordpress
</span></span></span><span style=display:flex><span><span style=color:#44475a>      # The &#34;name&#34;/&#34;suffix&#34; of the container name
</span></span></span><span style=display:flex><span><span style=color:#44475a>      name: wordpress
</span></span></span><span style=display:flex><span><span style=color:#44475a>      # List of environment variables
</span></span></span><span style=display:flex><span><span style=color:#44475a>      env:
</span></span></span><span style=display:flex><span><span style=color:#44475a>        - name: WORDPRESS_DB_HOST
</span></span></span><span style=display:flex><span><span style=color:#44475a>          value: mysql.default:3306
</span></span></span><span style=display:flex><span><span style=color:#44475a>        - name: WORDPRESS_DB_NAME
</span></span></span><span style=display:flex><span><span style=color:#44475a>          value: wordpress
</span></span></span><span style=display:flex><span><span style=color:#44475a>        - name: WORDPRESS_DB_USER
</span></span></span><span style=display:flex><span><span style=color:#44475a>          value: wordpress
</span></span></span><span style=display:flex><span><span style=color:#44475a>        - name: WORDPRESS_DB_PASSWORD
</span></span></span><span style=display:flex><span><span style=color:#44475a>          value: wordpress
</span></span></span><span style=display:flex><span><span style=color:#44475a>        - name: WORDPRESS_AUTH_KEY
</span></span></span><span style=display:flex><span><span style=color:#44475a>          value: SECURE_AUTH_KEY
</span></span></span><span style=display:flex><span><span style=color:#44475a>        - name: WORDPRESS_LOGGED_IN_KEY
</span></span></span><span style=display:flex><span><span style=color:#44475a>          value: SECURE_LOGGED_IN_KEY
</span></span></span><span style=display:flex><span><span style=color:#44475a>        - name: WORDPRESS_AUTH_SALT
</span></span></span><span style=display:flex><span><span style=color:#44475a>          value: SECURE_AUTH_SALT
</span></span></span><span style=display:flex><span><span style=color:#44475a>        - name: WORDPRESS_LOGGED_IN_SALT
</span></span></span><span style=display:flex><span><span style=color:#44475a>          value: SECURE_LOGGED_IN_SALT
</span></span></span><span style=display:flex><span><span style=color:#44475a>      # List of ports to &#34;publish&#34;
</span></span></span><span style=display:flex><span><span style=color:#44475a>      ports:
</span></span></span><span style=display:flex><span><span style=color:#44475a>        # ContainerPort exposes only to the inside of your network, not to the outside
</span></span></span><span style=display:flex><span><span style=color:#44475a>        # To reach the container we create a cluster wide service
</span></span></span><span style=display:flex><span><span style=color:#44475a>        - containerPort: 80
</span></span></span><span style=display:flex><span><span style=color:#44475a>          # gives the port a name
</span></span></span><span style=display:flex><span><span style=color:#44475a>          name: wordpress
</span></span></span></code></pre></div><h6 id=service>Service</h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#44475a>apiVersion: v1
</span></span></span><span style=display:flex><span><span style=color:#44475a></span># Service object
</span></span><span style=display:flex><span><span style=color:#44475a>kind: Service
</span></span></span><span style=display:flex><span><span style=color:#44475a>metadata:
</span></span></span><span style=display:flex><span><span style=color:#44475a>  # labels for the service
</span></span></span><span style=display:flex><span><span style=color:#44475a>  labels:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    name: wordpress
</span></span></span><span style=display:flex><span><span style=color:#44475a>  # name of the service
</span></span></span><span style=display:flex><span><span style=color:#44475a>  name: wordpress
</span></span></span><span style=display:flex><span><span style=color:#44475a>spec:
</span></span></span><span style=display:flex><span><span style=color:#44475a>  ports:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    # the port that this service should serve on
</span></span></span><span style=display:flex><span><span style=color:#44475a>    - port: 80
</span></span></span><span style=display:flex><span><span style=color:#44475a>  # label keys and values that must match in order to receive traffic for this service
</span></span></span><span style=display:flex><span><span style=color:#44475a>  selector:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    # select pods with the name &#34;wordpress&#34;
</span></span></span><span style=display:flex><span><span style=color:#44475a>    name: wordpress
</span></span></span></code></pre></div><h5 id=mysql-database-server>Mysql Database Server</h5><h6 id=pod-1>Pod</h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span># Kubernetes API version
</span></span><span style=display:flex><span><span style=color:#44475a>apiVersion: v1
</span></span></span><span style=display:flex><span><span style=color:#44475a></span># Type of <span style=color:#f1fa8c>&#34;request&#34;</span> in this <span style=color:#ff79c6>case</span> a Pod
</span></span><span style=display:flex><span><span style=color:#44475a>kind: Pod
</span></span></span><span style=display:flex><span><span style=color:#44475a></span># Metadata of the <span style=color:#f1fa8c>&#34;object&#34;</span>
</span></span><span style=display:flex><span><span style=color:#44475a>metadata:
</span></span></span><span style=display:flex><span><span style=color:#44475a>  # Name of the &#34;object&#34;
</span></span></span><span style=display:flex><span><span style=color:#44475a>  name: mysql
</span></span></span><span style=display:flex><span><span style=color:#44475a>  # Labels of the &#34;object&#34;
</span></span></span><span style=display:flex><span><span style=color:#44475a>  labels:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    # A lable named &#34;name&#34; with value &#34;mysql&#34;
</span></span></span><span style=display:flex><span><span style=color:#44475a>    name: mysql
</span></span></span><span style=display:flex><span><span style=color:#44475a></span># spec ~<span style=color:#ff79c6>=</span> Specificationsof the <span style=color:#f1fa8c>&#34;object&#34;</span>
</span></span><span style=display:flex><span><span style=color:#44475a>spec:
</span></span></span><span style=display:flex><span><span style=color:#44475a>  # List of Container definitions
</span></span></span><span style=display:flex><span><span style=color:#44475a>  containers:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    # The &#34;name&#34;/&#34;suffix&#34; of the container name
</span></span></span><span style=display:flex><span><span style=color:#44475a>    - name: mysql
</span></span></span><span style=display:flex><span><span style=color:#44475a>      # What Docker image to use
</span></span></span><span style=display:flex><span><span style=color:#44475a>      image: sameersbn/mysql:latest
</span></span></span><span style=display:flex><span><span style=color:#44475a>      env:
</span></span></span><span style=display:flex><span><span style=color:#44475a>        - name: DB_NAME
</span></span></span><span style=display:flex><span><span style=color:#44475a>          value: wordpress
</span></span></span><span style=display:flex><span><span style=color:#44475a>        - name: DB_USER
</span></span></span><span style=display:flex><span><span style=color:#44475a>          value: wordpress
</span></span></span><span style=display:flex><span><span style=color:#44475a>        - name: DB_PASS
</span></span></span><span style=display:flex><span><span style=color:#44475a>          value: wordpress
</span></span></span><span style=display:flex><span><span style=color:#44475a>      # List of container ports reachable from within the cluster
</span></span></span><span style=display:flex><span><span style=color:#44475a>      ports:
</span></span></span><span style=display:flex><span><span style=color:#44475a>        - containerPort: 3306
</span></span></span><span style=display:flex><span><span style=color:#44475a>          name: mysql
</span></span></span></code></pre></div><h6 id=service-1>Service</h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#44475a>apiVersion: v1
</span></span></span><span style=display:flex><span><span style=color:#44475a></span># Service object
</span></span><span style=display:flex><span><span style=color:#44475a>kind: Service
</span></span></span><span style=display:flex><span><span style=color:#44475a>metadata:
</span></span></span><span style=display:flex><span><span style=color:#44475a>  labels:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    name: mysql
</span></span></span><span style=display:flex><span><span style=color:#44475a>  name: mysql
</span></span></span><span style=display:flex><span><span style=color:#44475a>spec:
</span></span></span><span style=display:flex><span><span style=color:#44475a>  ports:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    # the port that this service should serve on
</span></span></span><span style=display:flex><span><span style=color:#44475a>    - port: 3306
</span></span></span><span style=display:flex><span><span style=color:#44475a>  # label keys and values that must match in order to receive traffic for this service
</span></span></span><span style=display:flex><span><span style=color:#44475a>  selector:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    # select pods with the name &#34;mysql&#34;
</span></span></span><span style=display:flex><span><span style=color:#44475a>    name: mysql
</span></span></span></code></pre></div><h5 id=phpmyadmin>phpMyAdmin</h5><h6 id=pod-2>Pod</h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span># Kubernetes API version
</span></span><span style=display:flex><span><span style=color:#44475a>apiVersion: v1
</span></span></span><span style=display:flex><span><span style=color:#44475a></span># Type of <span style=color:#f1fa8c>&#34;request&#34;</span>
</span></span><span style=display:flex><span><span style=color:#44475a>kind: Pod
</span></span></span><span style=display:flex><span><span style=color:#44475a></span># Metadata of the <span style=color:#f1fa8c>&#34;object&#34;</span>
</span></span><span style=display:flex><span><span style=color:#44475a>metadata:
</span></span></span><span style=display:flex><span><span style=color:#44475a>  # Name of the &#34;object&#34;
</span></span></span><span style=display:flex><span><span style=color:#44475a>  name: phpmyadmin
</span></span></span><span style=display:flex><span><span style=color:#44475a>  # Labels of the &#34;object&#34;
</span></span></span><span style=display:flex><span><span style=color:#44475a>  labels:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    # A lable named &#34;name&#34; with value &#34;phpmyadmin&#34;
</span></span></span><span style=display:flex><span><span style=color:#44475a>    name: phpmyadmin
</span></span></span><span style=display:flex><span><span style=color:#44475a></span># spec ~<span style=color:#ff79c6>=</span> Specificationsof the <span style=color:#f1fa8c>&#34;object&#34;</span>
</span></span><span style=display:flex><span><span style=color:#44475a>spec:
</span></span></span><span style=display:flex><span><span style=color:#44475a>  # List of Container definitions
</span></span></span><span style=display:flex><span><span style=color:#44475a>  containers:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    # The &#34;name&#34;/&#34;suffix&#34; of the container name
</span></span></span><span style=display:flex><span><span style=color:#44475a>    - name: phpmyadmin
</span></span></span><span style=display:flex><span><span style=color:#44475a>      # What Docker image to use
</span></span></span><span style=display:flex><span><span style=color:#44475a>      image: phpmyadmin/phpmyadmin
</span></span></span><span style=display:flex><span><span style=color:#44475a>      env:
</span></span></span><span style=display:flex><span><span style=color:#44475a>        - name: PMA_HOST
</span></span></span><span style=display:flex><span><span style=color:#44475a>          value: mysql.default
</span></span></span><span style=display:flex><span><span style=color:#44475a>      # List of container ports reachable from within the cluster
</span></span></span><span style=display:flex><span><span style=color:#44475a>      ports:
</span></span></span><span style=display:flex><span><span style=color:#44475a>        - containerPort: 80
</span></span></span><span style=display:flex><span><span style=color:#44475a>          name: phpmyadmin
</span></span></span></code></pre></div><h6 id=service-2>Service</h6><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#44475a>apiVersion: v1
</span></span></span><span style=display:flex><span><span style=color:#44475a>kind: Service
</span></span></span><span style=display:flex><span><span style=color:#44475a>metadata:
</span></span></span><span style=display:flex><span><span style=color:#44475a>  # labels for the service
</span></span></span><span style=display:flex><span><span style=color:#44475a>  labels:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    name: phpmyadmin
</span></span></span><span style=display:flex><span><span style=color:#44475a>  # name of the service
</span></span></span><span style=display:flex><span><span style=color:#44475a>  name: phpmyadmin
</span></span></span><span style=display:flex><span><span style=color:#44475a>spec:
</span></span></span><span style=display:flex><span><span style=color:#44475a>  ports:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    # the port that this service should serve on
</span></span></span><span style=display:flex><span><span style=color:#44475a>    - port: 81
</span></span></span><span style=display:flex><span><span style=color:#44475a>      # set the target of the port, in this case 81 -&gt; 80
</span></span></span><span style=display:flex><span><span style=color:#44475a>      targetPort: 80
</span></span></span><span style=display:flex><span><span style=color:#44475a>  # label keys and values that must match in order to receive traffic for this service
</span></span></span><span style=display:flex><span><span style=color:#44475a>  selector:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    # select pods with the name &#34;phpmyadmin&#34;
</span></span></span><span style=display:flex><span><span style=color:#44475a>    name: phpmyadmin
</span></span></span></code></pre></div><h4 id=kubectl---our-tool-to-rule-them-all>kubectl - Our tool to rule them all!</h4><center>![Kubernetes Zelda - It's dangerous to go alone](kubernetes-its-dangerous-to-go-alone.png)
_Zelda Meme intensifies_</center><p>The <code>kubectl</code> command is used to create new &ldquo;objects&rdquo;, view Pods, view Replication Controller and much more.</p><p>An example to view Pods in all namespaces:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#44475a>kubectl get --all-namespaces pods
</span></span></span></code></pre></div><blockquote><p><strong>WDWD</strong></p><ul><li><code>kubectl</code> - The kubectl command.</li><li><code>get</code> - Get &ldquo;objects&rdquo; from kubernetes API.</li><li><code>--all-namespaces</code> - Show objects from all namespaces.</li><li><code>pods</code> - Show only pods (Can be a comma seperated list of types, short forms are available).</li></ul></blockquote><p>Get all information about a Pod:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#44475a>kubectl describe --namespace=NAMESPACE TYPE NAME
</span></span></span></code></pre></div><blockquote><p><strong>WDWD</strong></p><ul><li><code>describe</code> - Call the describe routines.</li><li><code>--namespace=NAMESPACE</code> - Set namespace to search in (optional when set through kubeconfig file).</li><li><code>TYPE</code> - The type of objects to show. For example <code>pod</code>, <code>rc</code> (for replication controller).</li><li><code>NAME</code> - Name of the object to show. For our WordPress Pod, would be <code>wordpress</code>.</li></ul></blockquote><p>To create our WordPress, MySQL, phpMyAdmin Pod and Services, we run:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#44475a>kubectl create -f FILE_NAME
</span></span></span></code></pre></div><blockquote><p><strong>WDWD</strong></p><ul><li><code>create</code> - Creates an object.</li><li><code>-f FILE_NAME</code> - Can be one file, a directory or stdin.</li></ul></blockquote><p>In our case <code>FILE_NAME</code> would be the path to the <code>kubernetes202</code> task, <code>kubernetes202/</code>.
The files are read and the objects are created in alphabetical order (FIFO).</p><h4 id=summary-5>Summary</h4><p>We have now knowledge about creating kubectl files.
Our wordpress instance with the database is now running on the Kubernetes cluster, but currently not in HA mode (high Availability)</p><hr><h3 id=high-availability-and-balancing-with-loads---kubernetes>High Availability and &ldquo;Balancing with Loads&rdquo; - Kubernetes</h3><h4 id=kubernetes-balances-loads-by-default>Kubernetes balances loads by default</h4><p>Kubernetes uses iptables to &ldquo;balance&rdquo; the traffic between services that are running across the cluster.
<em>Not perfect, but a good software side approach using iptables.</em></p><h4 id=kubernetes-ingress-aka-reverse-proxing-between-multiple-webservers>Kubernetes Ingress aka &ldquo;Reverse Proxing between multiple webservers&rdquo;</h4><blockquote><p><strong>Please note</strong> Kubernetes Ingress doesn&rsquo;t support L7 ssl termination yet! See <a href=http://kubernetes.io/docs/user-guide/ingress/#the-ingress-resource>here</a>, list point <em>Global Parameters</em>.</p></blockquote><h4 id=pointers-tuts-and-docs-5>Pointers, Tuts and Docs</h4><ul><li>&ldquo;Native&rdquo; Docker<ul><li><a href=https://github.com/jwilder/nginx-proxy>jwilder/nginx-proxy</a> - Automatic Docker Nginx Proxy</li></ul></li><li>Multi Host<ul><li><a href=https://vulcand.github.io/>Vulcand</a></li><li><a href=http://weaveworks.github.io/flux/>Weave Flux</a></li><li><a href=http://kubernetes.io/docs/user-guide/ingress/>Kubernetes Ingress Support</a></li></ul></li></ul><hr><h3 id=the-end>The End</h3><p>If you have any questions about the <strong>workshop content</strong>, feel free to ask them in the comments or ask me directly at the workshop.</p><hr><h3 id=solutions>Solutions</h3><h4 id=for-the-nginx-dockerfile>For the <code>nginx Dockerfile</code></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span style=color:#44475a>FROM debian:jessie
</span></span></span><span style=display:flex><span><span style=color:#44475a></span>
</span></span><span style=display:flex><span><span style=color:#44475a>RUN apt-get update &amp;&amp; apt-get install -y nginx
</span></span></span><span style=display:flex><span><span style=color:#44475a></span>
</span></span><span style=display:flex><span><span style=color:#44475a>ENTRYPOINT [&#34;nginx&#34;]
</span></span></span></code></pre></div><h4 id=for-wordpress-docker-composeyml>For WordPress <code>docker-compose.yml</code></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span># Taken from https://www.digitalocean.com/community/tutorials/how-to-install-wordpress-and-phpmyadmin-with-docker-compose-on-ubuntu-14-04
</span></span><span style=display:flex><span><span style=color:#44475a>database:
</span></span></span><span style=display:flex><span><span style=color:#44475a>  image: sameersbn/mysql:latest
</span></span></span><span style=display:flex><span><span style=color:#44475a>  environment:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    DB_NAME: wordpress
</span></span></span><span style=display:flex><span><span style=color:#44475a>    DB_USER: wordpress
</span></span></span><span style=display:flex><span><span style=color:#44475a>    DB_PASS: wordpress
</span></span></span><span style=display:flex><span><span style=color:#44475a>  volumes:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    - &#34;/opt/docker/database:/var/lib/mysql:rw&#34;
</span></span></span><span style=display:flex><span><span style=color:#44475a>wordpress:
</span></span></span><span style=display:flex><span><span style=color:#44475a>  image: wordpress
</span></span></span><span style=display:flex><span><span style=color:#44475a>  links:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    - database:mysql
</span></span></span><span style=display:flex><span><span style=color:#44475a>  ports:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    - 8080:80
</span></span></span><span style=display:flex><span><span style=color:#44475a>  environment:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    WORDPRESS_DB_HOST: mysql:3306
</span></span></span><span style=display:flex><span><span style=color:#44475a>    WORDPRESS_DB_NAME: wordpress
</span></span></span><span style=display:flex><span><span style=color:#44475a>    WORDPRESS_DB_USER: wordpress
</span></span></span><span style=display:flex><span><span style=color:#44475a>    WORDPRESS_DB_PASSWORD: wordpress
</span></span></span><span style=display:flex><span><span style=color:#44475a>    WORDPRESS_AUTH_KEY: SECURE_AUTH_KEY
</span></span></span><span style=display:flex><span><span style=color:#44475a>    WORDPRESS_LOGGED_IN_KEY: SECURE_LOGGED_IN_KEY
</span></span></span><span style=display:flex><span><span style=color:#44475a>    WORDPRESS_AUTH_SALT: SECURE_AUTH_SALT
</span></span></span><span style=display:flex><span><span style=color:#44475a>    WORDPRESS_LOGGED_IN_SALT: SECURE_LOGGED_IN_SALT
</span></span></span><span style=display:flex><span><span style=color:#44475a>phpmyadmin:
</span></span></span><span style=display:flex><span><span style=color:#44475a>  image: corbinu/docker-phpmyadmin
</span></span></span><span style=display:flex><span><span style=color:#44475a>  links:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    - database:mysql
</span></span></span><span style=display:flex><span><span style=color:#44475a>  ports:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    - 8181:80
</span></span></span><span style=display:flex><span><span style=color:#44475a>  environment:
</span></span></span><span style=display:flex><span><span style=color:#44475a>    MYSQL_USERNAME: root
</span></span></span><span style=display:flex><span><span style=color:#44475a>    MYSQL_ROOT_PASSWORD: wordpress
</span></span></span></code></pre></div></article><footer class=post-footer><ul class=post-tags><li><a href=https://edenmal.moe/tags/Workshop><span class=tag>Workshop</span></a></li><li><a href=https://edenmal.moe/tags/Docker><span class=tag>Docker</span></a></li><li><a href=https://edenmal.moe/tags/Docker-for-Admins><span class=tag>Docker for Admins</span></a></li></ul><p class=post-copyright>© This page/post is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License, please give source if you wish to quote or reproduce.This post was published <strong>682</strong> days ago, content in the post may be inaccurate, even wrong now, please take risk yourself.</p></footer><script src=https://utteranc.es/client.js repo=galexrt/edenmal.moe issue-term=title label=blogpost theme=icy-dark crossorigin=anonymous async></script></section><footer class=site-footer><p>© 2017-2024 Alexander Trost</p><p>Powered by <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a> with customized theme <a href=https://github.com/laozhu/hugo-nuo target=_blank rel=noopener>Nuo</a>.</p></footer><link rel=stylesheet href=https://edenmal.moe/styles/icofont.min.min.css><script async src=https://edenmal.moe/cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.min.120e30ad299b8d6548dd1fbb6ab1d45fb508bf080219df63e5ab9750b1241207.js integrity="sha256-Eg4wrSmbjWVI3R+7arHUX7UIvwgCGd9j5auXULEkEgc="></script><script type=text/x-mathjax-config>
  MathJax.Ajax.config.path["MathJax"] = "/cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5";
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      displayMath: [['$$','$$'], ['\\[','\\]']],
      processEscapes: true,
      processEnvironments: true,
      skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
      TeX: { equationNumbers: { autoNumber: "AMS" },
      extensions: ["AMSmath.js", "AMSsymbols.js"] }
    },
  });
</script><script type=text/x-mathjax-config>
  // Fix <code> tags after MathJax finishes running. This is a
  // hack to overcome a shortcoming of Markdown. Discussion at
  // https://github.com/mojombo/jekyll/issues/199
  MathJax.Hub.Queue(() => {
    MathJax.Hub.getAllJax().map(v => v.SourceElement().parentNode.className += ' has-jax');
  });
</script><script src=https://edenmal.moe/scripts/index.min.0375b6e63e18876ff8d4ad95bf8ef081176b6b994398d5bd22f5140f45565d37.js integrity="sha256-A3W25j4Yh2/41K2Vv47wgRdra5lDmNW9IvUUD0VWXTc="></script><script>"serviceWorker"in navigator&&navigator.serviceWorker.register("/service-worker.js").then(function(){console.log("[ServiceWorker] Registered")})</script></body></html>