<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>iptables on Edenmal</title><link>https://edenmal.moe/tags/iptables/</link><description>Recent content in iptables on Edenmal</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><copyright>Â© This page/post is licensed under a Creative Commons Attribution-NonCommercial 4.0 International License, please give source if you wish to quote or reproduce.</copyright><lastBuildDate>Wed, 14 Sep 2016 15:50:49 +0200</lastBuildDate><atom:link href="https://edenmal.moe/tags/iptables/index.xml" rel="self" type="application/rss+xml"/><item><title>iptables: Using statistic module</title><link>https://edenmal.moe/post/2016/iptables-Using-statistic-module/</link><pubDate>Wed, 14 Sep 2016 15:50:49 +0200</pubDate><guid>https://edenmal.moe/post/2016/iptables-Using-statistic-module/</guid><description>&amp;ldquo;Load Balance&amp;rdquo; with iptables between two servers Kubernetes uses this method to load balance traffic between pods in the cluster.
The commands below create separate chains for each server and for the load balancing of port 80 in this case:
iptables -t nat -N LB_PORT80 iptables -t nat -N LB_PORT80_SERVER1 iptables -t nat -A LB_PORT80 \ -m statistic --mode random --probability 0.5000 \ -j LB_PORT80_SERVER1 iptables -t nat -N LB_PORT80_SERVER2 iptables -t nat -A LB_PORT80 \ -j LB_PORT80_SERVER2 iptables -t nat -A INPUT -p tcp -m tcp --dport 80 -j LB_PORT80 Dropping packages with a X% probability from a specific IP address My favorite rule to mess with people ;)</description></item></channel></rss>